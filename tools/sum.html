<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <title>Sum Number</title>
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

    <!-- font-awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

    <style>
        /* */
    </style>
</head>
<body>
    <div class="mx-auto mt-4" style="max-width: 300px;">
        <div class="text-center mb-2" style="font-size:1.2em">
            Just a plain simple online sum tool<br>
            <a href="#" class="btn btn-sm" onclick="info(); return false;"><i class="fa fa-question-circle-o" ></i></a>
        </div>
        <textarea id="data" class="form-control" style="height:300px" placeholder="paste data here"></textarea>
        <div class="d-grid gap-1">
            <button type="button" class="btn btn-primary" onclick="sumData()"><i class="fa fa-bolt"></i> Clean Data & Sum</button>
        </div>
        <div class="text-center border rounded m-0 row mt-2" style="background-color: whitesmoke;">
            <div class="col-4">
                <div>Count:</div>
                <div id="count" style="font-size:1.5em">---</div>
            </div>
            <div class="col-8">
                <div>Sum: <a href="#" onclick="copySum()"><i class="fa fa-copy"></i></a></div>
                <div id="sum" style="font-size:1.5em">---</div>
                
            </div>
        </div>
    </div>
</body>
<script>
    // @ts-check
    function sumData() {
        let data = $("#data").val()

        //Clean Data
        //data = data.replaceAll(".","");
        data = data.replaceAll(",","");

        // hapus karanter non numerik
        const reg = /[^(\d-\.)]/g;
        data = data.replace(reg,"\n");

        // delete double line
        while(data.search("\n\n")>=0){
            data = data.replace("\n\n","\n");
        }
        if(data.substr(0,1)=="\n") {
            data = data.substr(1);
        }
        $("#data").val(data);

        // sum
        let arr = data.split("\n");
        let total = 0;
        let n = 0;
        while (n<arr.length) {
            total+=arr[n]*1;
            n++
        }
        $("#sum").html(total);
        $("#count").html(n);
    }

    function copySum() {
        var copyText = document.getElementById("sum");
        navigator.clipboard.writeText(copyText.innerHTML);

    }

    function info() {
        alert(`- Paste number separated with new line.
- Any non-character will be converted to new line.
- Double space will be removed
- negatif value is supported
- "." treated as decimal separator`);
    }
</script>   
</html>